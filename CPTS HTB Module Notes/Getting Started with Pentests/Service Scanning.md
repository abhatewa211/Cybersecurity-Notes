## Service Scanning ‚Äî Finding What to Attack First

Before exploiting anything, we must answer:

> **What is running on this machine?**  
> **What services can I talk to?**  
> **What versions are they?**  
> **What can be abused?**

A **service** is an application listening on a port that performs a function (FTP, SSH, HTTP, SMB, SNMP, etc.). Our job is to find **misconfigurations** or **vulnerabilities** in these services.

---

## üß≠ Why Service Scanning Matters

- Identifies **attack surface**
    
- Reveals **OS type**
    
- Reveals **software versions**
    
- Reveals **misconfigurations** (anonymous login, weak shares, default creds)
    
- Gives direction for **vulnerability research**
    

---

## üîé Using **Nmap**

Nmap is the **#1 tool** for service discovery.

### Basic Scan (Top 1000 TCP ports)

```bash
naap 10.129.42.253
```

Output (important part):

```bash
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds
```

Key observations:

- FTP, SSH, HTTP ‚Üí likely Linux
    
- 139/445 ‚Üí SMB present
    

---

### Full Detailed Scan (what you should really run)

```bash
nmap -sV -sC -p- 10.129.42.253
```

Flags that matter:

|Flag|Meaning|
|---|---|
|`-p-`|Scan all 65,535 TCP ports|
|`-sV`|Service version detection|
|`-sC`|Default NSE scripts|

This reveals:

- FTP allows **anonymous login**
    
- SSH version and Ubuntu build
    
- Apache version
    
- Samba version
    
- Hostname
    
- OS hints
    

---

## üñºÔ∏è PHPInfo Page Discovered

The scan shows:

```
http-title: PHP 7.4.3 - phpinfo()
```

This means the server exposes a **phpinfo page** ‚Äî a goldmine of info.

![Image](https://teampasswordmanager.com/assets/img/site/docs/phpinfo.png)

![Image](https://assets.digitalocean.com/articles/lamp_ubuntu2004/phpinfo.png)

![Image](https://docs.bitnami.com/images/img/components/php/check-phpinfo.png)

![Image](https://cms-assets.tutsplus.com/cdn-cgi/image/width%3D360/uploads/users/413/posts/34452/image/introduction-to-the-php-configuration-file-php-ini-location.png)

This page can reveal:

- PHP version
    
- Server paths
    
- Modules
    
- OS info
    
- Environment variables
    

---

## üß∑ Banner Grabbing (Manual Fingerprinting)

Instead of relying only on Nmap:

```bash
nc -nv 10.129.42.253 21
```

Output:

```
220 (vsFTPd 3.0.3)
```

This is called **Banner Grabbing**.

---

## üìÅ FTP Enumeration

Nmap told us:

```
Anonymous FTP login allowed
```

Connect:

```bash
ftp -p 10.129.42.253
```

Login as:

```
anonymous
```

Commands that matter:

|Command|Use|
|---|---|
|`ls`|List files|
|`cd`|Change directory|
|`get`|Download file|

We find:

```
login.txt
admin:ftp@dmin123
```

‚û°Ô∏è Credentials from FTP ‚Üí may work for SSH, SMB, web login.

---

## üóÇÔ∏è SMB Enumeration (Very Important)

SMB is a **huge attack surface**.

Run SMB OS discovery:

```bash
nmap --script smb-os-discovery.nse -p445 10.10.10.40
```

This can reveal:

- Windows version
    
- Hostname
    
- Workgroup
    
- Time
    

### List Shares

```bash
smbclient -N -L \\10.129.42.253
```

We see:

```
users
```

Connect with creds:

```bash
smbclient -U bob \\10.129.42.253\users
```

We find:

```
passwords.txt
```

Download:

```
get passwords.txt
```

---

## üñ•Ô∏è What This Tells Us

SMB often contains:

- Password files
    
- Config backups
    
- Scripts with creds
    
- Employee data
    

This is extremely common in real networks.

---

## üì° SNMP Enumeration (Often Forgotten, Very Powerful)

SNMP uses **community strings** like passwords.

Try defaults:

```bash
snmpwalk -v 2c -c public 10.129.42.253
```

Result:

```
Linux gs-svcscan 5.4.0-66-generic
```

We just learned:

- Hostname
    
- Kernel version
    
- OS
    

Bruteforce strings:

```bash
O onesixtyone -c dict.txt 10.129.42.254
```

---

## üß† Key Mindset During Service Scanning

For **every open port**, ask:

|Question|Why|
|---|---|
|What service is this?|Identify attack vector|
|What version?|Search CVEs|
|Misconfiguration?|Anonymous login, weak shares|
|Can I authenticate?|Try creds everywhere|
|Can I extract data?|Files, banners, info leaks|

---

## üß® Most Important Takeaways

- Always run: `nmap -sV -sC -p-`
    
- Banner grabbing is powerful
    
- FTP often leaks creds
    
- SMB often leaks files
    
- SNMP leaks system info
    
- PHPInfo is a goldmine
    
- Credentials found in one service often work in another
    

This phase **dictates your entire attack path**.

![[Pasted image 20260205225822.png]]

### Steps for getting the answer and Solving the Module.

Step1. Spawn the VPN system (Tunneling) by openvpn using command.
![[Pasted image 20260206115543.png]]
In the above Screenshot we are going to download VPN File for tunneling Purpose.

![[Pasted image 20260206115728.png]]
In this SS we have downloaded the VPN File.

![[Screenshot From 2026-02-06 12-05-11.png]] 
As shown in above image run the open vpn command and you will get the the IP for VPN Image Below.
![[Screenshot From 2026-02-06 16-25-35.png]]
Step2. Spawn the target system and copy the IP:PORT
