## Connecting Using a VPN (For Pentesting & HTB)

A **VPN (Virtual Private Network)** allows us to connect to a **private/internal network** as if we were physically inside it.

For penetration testers, this is critical because:

- Client internal tests are often done through VPN
    
- Labs like **Hack The Box** require VPN access
    
- We must access **non-public, non-routable networks** safely
    

---

## ğŸŒ What a VPN Actually Does

![Image](https://images.openai.com/static-rsc-3/Yd4tqcHcIn5gBoXwrGIuzkZMYqai8Ntje0sJ620luX-jd3BIW2vB_0XEK0cgHfottfv_DQGzya0VtFh2cvq2cVOQpa00LzxYT1WSqK5nsqM?purpose=fullsize&v=1)

![Image](https://images.openai.com/static-rsc-3/lGAG2pMIzwjIVvrB438pMmZu7ktfirwnrdW9PpyXBTtF42eO19DHkTN32p6z8VsXjQnox8K0TuRdPDGy24_UbHvoI9pN29hL9bSiK6O-i1o?purpose=fullsize&v=1)

![Image](https://openmaniak.com/openvpn/openvpn_routing.gif)

![Image](https://image.ibb.co/n0DNDb/vpn_pfsense_routing.jpg)

At a high level, a VPN:

- Creates an **encrypted tunnel** between your machine and the VPN server
    
- Routes traffic **through the VPN server**, not your ISP
    
- Makes you appear as if you are **inside the target network**
    
- Allows access to **internal IP ranges** (e.g., 10.x.x.x, 172.16.x.x, 192.168.x.x)
    

Your traffic:

```
Your VM â†’ Encrypted Tunnel â†’ VPN Server â†’ Internal Network
```

---

## ğŸ” Types of Remote Access VPN

|Type|How it Works|Use Case|
|---|---|---|
|**Client-based VPN**|Requires VPN client software (e.g., OpenVPN)|Full internal network access|
|**SSL VPN**|Works through a web browser|Limited to web apps or portals|

Pentesters almost always use **client-based VPNs**.

---

## ğŸ§ª Why VPN Matters for Pentesters

You will use VPN when:

- Performing **internal penetration tests**
    
- Accessing **lab environments**
    
- Connecting to **segmented corporate networks**
    
- Pivoting into internal subnets during testing
    

âš ï¸ Important: VPN â‰  anonymity. It is **access**, not privacy.

---

## ğŸ§¨ Treat Lab VPNs as Hostile Networks

When connecting to HTB or any lab:

- Only connect from a **VM**
    
- Disable SSH password login on your VM
    
- Do not store client data on this VM
    
- Do not reuse this VM for client work
    
- Assume other users could try to scan or attack you
    

---

## ğŸ–¥ï¸ Connecting to HTB VPN with OpenVPN

HTB provides a `.ovpn` file.

Use **OpenVPN** to connect:

```bash
sudo openvpn user.ovpn
```

Successful connection ends with:

```
Initialization Sequence Completed
```

This means the tunnel is established.

---

## âœ… Verify the VPN Connection

### 1) Check for TUN Interface

```bash
ifconfig
```

Look for:

```
tun0
```

This is your VPN tunnel adapter.

---

### 2) Check Routing Table

```bash
netstat -rn
```

You should see routes like:

|Network|Interface|
|---|---|
|10.10.x.x|tun0|
|10.129.x.x|tun0|

This confirms traffic to HTB networks goes through VPN.

---

## ğŸ§­ Whatâ€™s Happening Internally

- `tun0` = virtual network adapter created by OpenVPN
    
- Your machine now has an IP like `10.10.x.x`
    
- You can now reach HTB targets like `10.129.x.x`
    

Without VPN â†’ these IPs are unreachable.

---

## ğŸ› ï¸ Common VPN Issues

|Issue|Cause|Fix|
|---|---|---|
|No `tun0`|VPN not connected|Reconnect OpenVPN|
|Canâ€™t reach targets|Routing issue|Check `netstat -rn`|
|DNS issues|Local DNS conflict|Use IPs directly|
|Slow connection|Wrong region|Download closer VPN profile|

---

## ğŸ§  Real-World Relevance

This is **exactly** how internal pentests happen:

> Client gives you a VPN profile â†’ you connect â†’ you are â€œinsideâ€ their network.

Same process. HTB is simulating real pentest workflow.

---

## ğŸ Key Takeaways

- VPN gives you **internal network access**
    
- `openvpn user.ovpn` is your entry point
    
- `tun0` confirms success
    
- `netstat -rn` shows reachable networks
    
- Always use a **dedicated VM**
    
- Treat lab VPNs as hostile environments
    

This is a fundamental skill you will use in **every real internal penetration test**.